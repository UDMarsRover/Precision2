# Precision2
Welcome to the repository for Precision2. This repository is based on much of the source code developed in Precision1. However, with a reorganization of packages, a switch to ROS2, and much more, this repository is being built from the ground up. 

## Wiki
General/getting started information can be found in this ReadMe. However, more specific, generalized information for developers can be found in [the wiki](https://github.com/UDMarsRover/Precision2/wiki).

## Step 1 - Install an Ubuntu 22.04 VM on your laptop
I recommend VMWare Workstation Pro 17 for Windows, VMWare Fusion for Mac, or KVM for Linux. You will have to do your own research to figure out how to install an Ubuntu 22.04 Desktop VM with your selected VM software. 

Please install a VM with at least the following specs:
- 64 GB storage
- 8 GB Memory
- 4 CPU Cores

## Step 2 - Connect your VM to your Git account
In your new Ubuntu VM, open the Terminal application. Run the command, 
```
ssh-keygen
```
Then, press enter for each prompt, until an SSH key is generated, which you will use to connect to git. Proceed by running the command, 
```
cat .ssh/id_rsa.pub
```
The output will be the SSH key generated by the VM. Copy this output by highlighting it and pressing ctrl+shift+c, or right clicking and pressing copy. 

Navigate to github.com and sign in, or create an account if you do not have one.

Go to settings by clicking your icon in the top right of the page, and navigate to Settings > SSH and GPG Keys, and press `New SSH Key`. You will then be able to enter a title, which should be a descriptive name of your VM, like "UDMRT Ubuntu 22.04 VM on my Macbook in VMWare Fusion". Then, paste the key generated by Ubuntu. Finally, press `Add SSH Key`. Good work, your VM is now connected with your GitHub account. 

To get added to the UDMRT Computer Team, visit [this form](https://forms.gle/hWcz3sa8TFxpy7vH9) to request access. I will be manually adding email addresses to the team as they come in. 

To ensure future commits you make can be tracked, run the following commands in the Ubuntu terminal, replacing Firstname, Lastname, and Email with yours.
```
git config --global user.name "Firstname Lastname"
git config --global user.email "Email"
```
## Step 3 - Install Visual Studio Code
In Firefox in your Ubuntu VM, search for "download VS code"

Download the .deb file. If you are on an Arm processor, be sure to specify the correct architecture when you download.

Go to Files in Ubuntu, then to Downloads, then right click the deb file, select Open With Other Application > Software Install. Then, you can press install to begin installing VS Code on your device. 

Alternatively, if you know how to do so, you can use SSH to edit code in your VM.

## Step 4 - Clone this getting started repo
When we work with the actual UDMRT, I will allow your user to access the repo, and you can clone it via SSH, which allows you to make modifications. however, for this demo, you don't need to push to the repository, so we will clone with HTTPS. 

In your Ubuntu 22.04 VM, run the command, 
```
git clone https://github.com/UDMarsRover/ros2-demo.git
```
You will now have the files for this repository on your local machine. 
If the command fails because git is not installed, run `sudo apt-get install git`, and try again.

## Step 4 - Installing ROS 2 Humble
This repository contains an install script that can be run within your Ubuntu terminal. Navigate to this repository (`cd ros2-demo`), then run the command: 
```bash
bash ros2-setup.sh
```

## ROS2 Version
For Precision2, we will be using [ROS2 Humble Hawksbill](https://docs.ros.org/en/humble/index.html).

## Creating Packages
To create a ROS2 package, use the following command from the reposiroty `src/` directory:
```bash
ros2 pkg create --build-type ament_python <package_name>
```

## Creating a Node
To create a node, create a file in the correct location, which follows the format:
```
Precision2/src/<package_name>/<package_name>/<your_script.ext>
```
Here, the script will usually be a `.py` file. 
Then, add the executable to the `setup.py` file: 
At the bottom of the `Precision2/src/<package_name>/setup.py` file, you will see something like this
```python
entry_points = {
  'console_scripts': [
    '<node_name> = <package_name>.<script_name>:main'
  ]
}
```
Add a new element to `console_scripts` for your executable. The `<node_name>` should be a name for your executable (the name used by `ros2 run`). The `<package_name>` should match the name of the package, and the `<script_name>` should be the name of your script(if the file is `ros_pub.py`, you would replace `<script_name>` with `ros_pub`). Finally, your script will need a `main` function in it that will be called upon execution. 

Lastly, ROS uses a program called 'rosdep' which manages dependencies. To ensure any external dependencies you are using are accessible across computers, add these to the `Precision2/src/<package_name>/package.xml` file. To do so see [Managing Dependencies With Rosdep](#). TODO: add link
## Building Packages
From the repository's root directory, run the command:
```bash
colcon build
```

## Installing Packages
To source the installation of the package (you need to do this to run any of the built ROS nodes), run the command from the repository's root directory:
```bash
source install/setup.bash
```

## Running Nodes

## UDMRT Network
ssid - 'udmrt-dev-1'
password - 'precision1'
